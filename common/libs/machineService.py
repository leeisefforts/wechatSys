from application import app, dbfrom common.libs.WebHelper import getCurrentDatefrom common.libs.goods.goodsService import GoodsServicefrom common.model.wechat.Machine_Weimob import Machine_Weimobimport random, stringclass MachineService:    def __init__(self):        pass    def __createcardcode__(self):        src_digits = string.digits  # string_数字        src_uppercase = ['A', 'B', 'C', 'D', 'E', 'F']  # string_大写字母        for i in range(8):            # 随机生成数字、大写字母、小写字母的组成个数（可根据实际需要进行更改）            digits_num = random.randint(1, 4)            uppercase_num = random.randint(1, 8 - digits_num)            # 生成字符串            password = random.sample(src_digits, digits_num) + random.sample(src_uppercase,                                                                             uppercase_num)            # 打乱字符串            random.shuffle(password)            # 列表转字符串            new_password = ''.join(password)            return new_password    def __saveorderinfo__(self, order_info):        cardcode = self.__createcardcode__()        cardcode_isVaild = Machine_Weimob.query.filter_by(cardcode=cardcode).first()        while cardcode_isVaild:            cardcode = self.__createcardcode__()            cardcode_isVaild = Machine_Weimob.query.filter_by(cardcode=cardcode).first()        for item in order_info['itemList']:            machine = Machine_Weimob()            machine.cardcode = cardcode            machine.goodsId = item["goodsId"]            machine.goods_name = item["goodsTitle"]            machine.orderNo = order_info['orderNo']            machine.createtime = getCurrentDate()            machine.orderStatus = order_info['orderStatus']            machine.pid = order_info['merchantInfo']['pid']            machine.merchantTitle = order_info['merchantInfo']['merchantTitle']            machine.wid = order_info['orderSplitListResponse']['customerWid']            machine.userNickname = order_info['orderSplitListResponse']['customerNick']            db.session.add(machine)            db.session.commit()        return True